## How Pentesters Build Their Labs
Before you start building your own pentesting lab, it may help you to learn how other sucessful people have done it. We asked some people in the industry about their pentesting labs. Hopefully, you will get some ideas and be inspired!

Chris Kubecka is notable in the cybersecurity industry for restoring Saudi Aramco's network from one of the world's most destructive cyberwarfare attacks in 2012. We asked her how she built her pentesting lab.

#### Chris Kubecka 
“I prefer using a locked down Windows or Linux-based operating system that will be compatible with the target. Kali is not setup secure, which means it can leave it open to attack. Most of my engagements in- person have discovered an attacker already present. The tools in Kali are not set up with security in mind, using default ports, default credentials, or have their own known exploits. Nmap, for instance, has several in-built scripts that can be used to exploit a default configuration Metasploit instance. If your pentest has collected private, critical data, or health data, you, as the tester, can be a wonderful point of an attacker. That is why it is important to secure your pentesting system, even if you use Kali. 

I incorporate IT, web application, IT networking, IoT [Internet of Things], and ICS [industrial control systems] with encryption and hash deciphering. Included are aspects of technical social engineering and things like attacks through a browser using JavaScript and attacks against browsers like collected passwords stored in plain text once a target machine is acquired and the browser can be attacked. Lastly, metadata tools. These require additional tools. 

FOCA is a metadata tool that looks at documents, pictures, presentations, and so on. It can sift through the hidden metadata and map out internal networks, external networks, show which software versions are in use, usernames, passwords if present, printers, lots.” 

Why did she design her lab that way? 

“The big why is out of necessity. Kali is great, but it is constrained by known vulnerabilities and exploits. It is also based on IT systems, not IoT and ICS for the most part. If Metasploit has an exploit in its library, great. If it doesn't, no. Some of the known exploits in various Kali tools may also have low chances or perform poorly in a system versus Metasploit modules that are graded ‘great,' which are the opposite. Once you learn how exploits work, what the scripts are doing, you can  write many exploits with multiple programming languages. You can also expand them. For instance, an exploit might be known to work against Vendor version X, but you learn that other vendors use the same vulnerable library that can be exploited, but either in the same or a slightly different way.” An anonymous person told us about their lab. We don't know why they prefer to be anonymous. We know their identity, but it's important to respect someone's privacy if they request it. Here's what they told us about their tools.

### Anonymous 1 

“I built all my own tools. I built network packet crafting, hard drive recovery, self-modifying executables.” 

Like Chris Kubecka, our anonymous source clearly has a lot of computer programming know-how. Network packets are the data we send over networks, such as the Internet. It sounds like they were making them from scratch! 

“Much of my research was on client-side applications, security control systems.” 

A client-side application is pretty much any sort of application your PC uses. Clients, otherwise known as endpoints, are the computers we use to interact with networks. Your PC and phone are common types of client machines. 

“I built targeted payloads for pivots.” 

A payload in malware is the part that does the actual damage to an infected computer. For instance, a ransomware's payload starts the work of maliciously encrypting a victim machine's files. 

“I built my own reverse engineering tools in C#. Everything I wrote was on Visual Studio.” 

Reverse engineering an application is taking it apart to look at its computer programming code. 

“I created application injection payloads to move and pivot around a computer. It got baked into a Metasploit payload. I released my source code hidden in a puzzle only people who loved to crack applications would find.”

So, an application injection payload is the part of malware that gets inside a vulnerability in an application in order to do harm to a computer. And by hiding their source code in hacker puzzles, our anonymous hacker sounds like a mysterious character in a cyberpunk novel. Fascinating!

### Simon Bennetts
Simon Bennetts told us a story about his pentesting lab and how it was useful for him. 

“In 2009 I was a Java developer and team leader. I led a small team which developed an online service for a major accounting software company. As this service was considered to be security critical, I insisted that an external pentest team was hired to ensure the software was suitably secure. 

I remember walking into the room in which we'd set up the pentesters after just one hour to check they had everything they needed, only to find one of them logged into our admin console as me. We had only given them test credentials, and they already had admin access to the system! In this particular case, it was not my service that was at fault, they had in fact cracked the whole company's Single Sign On system!” 

That's impressive! And kind of scary. 

“The final report, when it was delivered, looked like a car crash. I've since found out that it actually wasn't that bad and have now written much more damning reports myself. However, it also included vulnerabilities that I'd never heard of, including Cross Site Request Forgery.” 

A cross-site request forgery happens when a user is authenticated into a web application and a cyberattacker hijacks their session to perform unwanted actions within the application. For example, let's say that you were logged in to your Facebook account in your web browser. Facebook is a web application in which you are authenticated. A cyberattacker exploits your session to make spam posts under your account, advertising some sort of scam. Attacks like that are possible through the kinds of web vulnerabilities that you may find as a pentester. 

“I realized that I knew less about web security than I thought and that I needed to learn a lot more very quickly. The pentesters pointed us to OWASP, which I'm afraid to say I'd never heard of, and so I started with the OWASP Top Ten before moving on to some of the other OWASP guides. While the guides were very good, I find that I learn best by doing things rather than just reading about them, so I started playing around with various open source security tools. 

I've always had side projects, but at that time I had never contributed to open source. I decided it was a good time to start contributing, so looked around for an open source security tool with an active community. Unfortunately, I couldn't find one. OWASP had WebScarab, but I didn't really get on with that, and in any case development on that seemed to have stopped. 

The tool I most liked was called Paros Proxy. It was simple, effective, and did what I needed. It was also written in Java, so it wasn't long before I pulled in into Eclipse [an application for developing in the Java programming language] and started making some tweaks. 

I found that other developers and QA people at the company were also somewhat lacking in security knowledge, so I started giving talks on the OWASP Top Ten.” 

Simon explained further about the tools he has used.

“I decided to do a proper investigation. I wanted the tool I recommended to be free, opensource, and cross platform. It needed to do all of the basics but didn't have to be a hardcore pentesters' tool. Ideally it would also have an active community.” 

So, in layperson's terminology, he wanted a tool that has source code that's available to the public, which can work within multiple operating systems and web browsers; hence, open source and cross-platform. 

“I couldn't find anything that met those criteria. The closest tool was Paros, or rather the version of Paros I was hacking around with! I took the plunge, forked Paros, renamed it ZAP, and announced it on BugTraq. I also proposed it as an OWASP tool and was actually very surprised when it was accepted a couple of months later. 

ZAP was always intended to be a community tool, and since its release hundreds of people have contributed to it. It's now managed by a core team and has become the world's most frequently used web application scanner.” That's incredibly impressive. He built a web application scanner that became the most popular application in its category!

### Jason Wheeler
Jason Wheeler isn't a full-time pentester, but he often pentests in his work. 

“Lately, a lot of my work can't be discussed as it's pending, but I can still talk about methodologies and tools used. I hack on a wide range of topics from web applications, hardware hacking, phone apps, to finding weaknesses in cryptography (implementation mostly). You name it, I most likely dabbled in it, except for social engineering, which I'm not very good at yet. 

As far as my lab goes, it's quite extensive. My personal lab has one bare metal server [a server which just runs an operating system directly, no virtual machines] with 1080 Ti GPUs for hardcore mathing, 4 hypervisors with multiple full-blown networks from Windows 7 to Server 2019, IDS (intrusion detection system), and SIEM (security information and event management, a special system for detecting cyberattacks). 

My lab is always changing to fit what I am currently researching. Also use ZeroTier to connect networks together to share resources or I alternate to a VPN for red team games we host. My work lab is quite large, but I'm limited on what I can say about it.” 

The pentesters we've spoken to have so many secrets! We asked another anonymous person how they built their pentesting lab. 

“Our lab started simply as a network we conducted our remote activities from, as well as a network that was used to conduct reconnaissance against our targets—host discovery, host enumeration and host banner grabbing. We did not have commercial tools that were able to meet our operational requirements and (like most) built it in- house. The only commercial tool we were able to incorporate into our operations was CORE IMPACT, which was used to initial access and after which we would upload our in-house developed implant.” 

So far, we've spoken to some of the world's top ethical hackers. Computer programming and application development knowledge will be useful to you as a pentester. Fortunately, as you start your pentesting journey, you won't be expected to develop your own tools from scratch. For the first several years of your career, being able to use applications other people have developed should be satisfactory. But maybe one day you will develop some of your own pentesting applications! Until then, maybe you will use some of the applications the pentesters we've spoken to developed. Once you get into the cybersecurity industry, you will find it's a very small world! 

We asked another anonymous pentester about the tools they use and why.

### Anonymous 2
“We used Nmap, CORE Impact, and that's about it. We did reverse engineer and clean up a lot of public exploits and then re-use them, but as a ‘tool' in the common sense, we used mainly in-house development. 

Operations followed the common methodology of Recce, enumerations, exploitation, expand and secure access, actions on network, clean-up, and get out.” 

Recce is military terminology for reconnaissance work. 

“Automation and tools allowed us to have a measurable and repeatable process. These two key aspects helped set us apart from our peers in that we were able to show change over time for our clients. We could compare them to others in their industry. With our ability to store and database, we could quickly seize the initiative when new RCE (remote code execution) was available because we knew from our saved data which clients were exposed.” 

Remote code execution is what it sounds like. Someone has a computer, and they're executing code on a different, remote computer.

### Ted James
Tes James specializes in web application security.

"In the early 90s, I was working as a technical writer for a software company that had us writing using an SGML variant [Standard Generalized Markup Language is kind of like webpage development code, but various types of documents.] A few years later, when the Web became a thing, I realized I already knew how to write HTML. [HTML is the main language web pages are written in.] I just needed to learn the tags. I built a few sites for some projects I was working on and ended up creating an intranet for my division at work. I had a lot of fun experimenting and dissecting existing sites and apps to learn how they worked and figure out how i could apply the functionality to my own sites. I 'appropriated' and modified a lot of great code in the process. Flash forward many years and many job changes. My first job in information security was as a technical writer for a team of penetration testers."

Ted described how he got into pentesting. 

“When I was finally able to move into a full-time information security position, my new boss asked me what I wanted to learn to help me in my job. I told him that I wanted to learn penetration testing, so he bought me the eLearnSecurity Penetration Testing Student course. I picked up some great skills and knowledge, including creating a penetration testing lab with Kali Linux. My agency (state government) needed someone to test our new and existing web applications, so I jumped on the opportunity.” 

He explained his specific web application hacking tools. 

“We were already using Nessus, but we upgraded to Tenable.IO. The upgrade included Tenable's Web Application Scanning (WAS). I run both credentialed and non-credentialed scans. For credentialed scans, I use Selenium scripts. I found a great browser plugin (Selenium IDE) for that. WAS is also perfect for creating site maps. When testing applications, it's necessary to map out all possible attack surfaces. 

I use OWASP-Zed Attack Proxy (ZAP) for both passive and active scanning. ZAP is really an amazing tool in that it contains so many functions. It's also fully open source and community driven. If I need to intercept traffic, I can use it as a proxy. Otherwise, I really love ZAP's Manual Explore option. I love how it lets you explore an application, collecting vulnerabilities along the way. It's also perfect for creating Cross-Site Request Forgery (CSRF) proofs-of-concept.” 

Oh wow! We just spoke with ZAP's developer, Simon Bennetts! Ted continued to explain another of his tools. 

“I use the Burp Suite Community Edition as a proxy when I need to intercept and manipulate web traffic and to map applications.” 

Pete Herzog went into detail when he described his pentesting lab. Hopefully you'll find this information useful!

### Pete Herzog
"The lab has two parts: a front and back end. The front has the tools and the back has the servers. Even though we made it much more complicated over the years to accommodate AI mentoring and VR, the design is still the same.” 

Artificial intelligence and virtual reality? Cool stuff! 

“I think most labs now are made with Docker or some other virtualization for easy spin-up and static configuration. The static part is so it can be reset, important if you do any scoring in a CTF or requiring it to be broken for a pentest class or even a virtual escape room. 

The tools we focus on in-depth for our certification classes are: 
* Ping: Hping3 
* Traceroute: Tcptraceroute 
* Netcat 
* OpenSSH 
* Nmap 
* Dig, Whois, DNSLint 
* Wireshark, TCPdump 
* Burp 

The students are free to experiment and try all the other tools in Kali or Parrot (another pentesting operating system) or whatever, but what we want them to know is the basis of how the tool works and what it's doing.”

### BLuef0x
Finally, we asked BLuef0x about how they started and their pentesting lab.

"I started by going to HackMiami meetings and conferences back in 2018, as well as DC813 and The Undercroft meetups. There I made friends with fellow hackers who talked and showed me various tools for pentesting, as well as network defense. Also, I started going online using YouTube to do virtual schooling, and I self-taught on setting up my lab at home, which I built. My time in the army also showed me how basic InfoSec systems worked, both internally and externally.

The first tools I learned were Nmap and Wireshark. These tools are a powerful combination where they are used to analyze a basic entry into a network, a server, or even standalone terminals. Now, assume your location is okay with using Nmap and the destination of the scan, you can begin to find out more about the target. Wireshark helps with finding out more about how and who the target is talking to such as websites, types of requests for information, or access to a site. Wireshark can be used on wired and wireless connections. So, gathering info about the target using both Nmap and Wireshark alone can tell you how the target operates. Another tool I use is social engineering where i would gather ingormation about a target by talking to other people who are associated with the target."

We think this really reinforces how important Nmap and Wireshark will be when you explore networks as a pentester.

