## Information Security Basics

Pentesting is a process that aids in improving information security. By finding
vulnerabilities of all kinds in software, hardware, and networking devices, you
can patch, remove, or mitigate these weaknesses. It will definitely help you to
become a more effective pentester if you acquire a good general understanding
of information security.

### What Is Information Security?
Information security is the process of protecting information. As renowned
computer security expert Bruce Schneier always says, “Security is a process, not
a product.”

He means that keeping information secure
isn't a matter of just setting up a data system in a secure way, buying some
security products, and then forgetting about it. Information security requires constant attention.

### The CIA Triad
The most fundamental concept in information security is the CIA triad. 
The CIA triad stands for confidentiality, integrity, and availability. All information security
vulnerabilities, exploits, and attacks pertain to one or more of the three
components of this triad.
* Confidentiality is making sure that data is only accessible to authorized parties. Cryptography is a major way that the confidentiality of data is protected.
* Integrity is making sure that data isn't changed, altered, or removed without authorization.
* Availability means that data is there when it's needed. One of the most common cyberattacks on availability is distributed denial of service (DDoS) attacks.

### Security Controls
Security controls are the means and ways of protecting the information security
of computer systems. Enforcing and implementing them is a blue team matter,
but penetration testing them is a red team matter. When you pentest, you'll be
testing the effectiveness of the security controls in your targeted system. Here's a
brief summary of them.

ISO/IEC 27002 (www.iso.org/standard/54533.html) is a standard from the
International Organization for Standardization and the International
Electrotechnical Commission that defines security controls.

Administrative controls are the policies, guidelines, standards, and procedures
that an organization designs to manage how activities can be conducted in a
secure way. These controls also include regulations and laws enacted by
government bodies. For instance, the General Data Protection Regulation
(GDPR) (gdpr-info.eu) in the European Union regulates how data pertaining to
European individuals and entities should be managed securely.

The principle of least privilege is a very common and important logical control.
It means that people should only have access to the data and computer systems
they need to do their work—and absolutely no more.

Physical controls ensure that people don't have unauthorized physical access to
computer systems and data. Locks on doors to the server room make sure that
the only people who can touch an enterprise's servers with their own hands are
those who need to have access to them to keep their network's backend going.

### Access Control
Access control is often considered to be the bedrock of most information security
measures. Keeping information secure is about making sure that only authorized
parties have access to the specific components of information systems.

### Role-based Access Control
Role-based access control (RBAC) permits access according to a user's role
within an organization. It's the practice that you'll see most often in network
settings. That's because it's a very efficient way to implement the principle of
least privilege. Accountants can be put into an accounting group and be given
access to the financial servers. However, they will not be given access to the
machines that network administrators use to manage the network. however, they can deny themselves write permissions to the
financial servers, and so forth. Because specific permissions can be granted to
user groups, and users are put into user groups according to their roles, a lot of
time and energy is saved when compared to designating permissions for each
individual user.

### Mandatory Access Control
Mandatory access control (MAC) is often used in environments with very strict
security needs. It's associated with the multilevel security systems that were
designed to protect data that has been classified by military and intelligence

agencies. But MAC has evolved to be used well beyond military and intelligence
networks. For instance, you will often see MAC in the financial services industry
as well.
In a MAC system, security policy is typically centrally controlled by a security
policy administrator. Users cannot delegate permissions themselves.
In a MAC system, security policy is constrained according to system classification, configuration, and authentication.

### Discretionary Access Control
Discretionary access control (DAC) is the third major access control practice
you'll often see as a pentester. The United States Department of Defense's
Trusted Computer System Evaluation Criteria (TCSEC) define DAC as “a means
of restricting access to objects based on the identity of subjects and/or groups to
which they belong.

## Incident Response
Incident response is how organizations respond to cyberattacks. If the simulated cyberattacks you conduct in your pentesting were real cyberattacks by real cyberattackers, specific policies and procedures would define how an organization must react.

#### Preparation
Know who to contact when an incident is detected. Every member of a CSIRT team should have that information. CSIRT members and any parties that must be contacted when an incident is discovered should be able to communicate with each other and act quickly. Network administrators in the CSIRT should make sure that any devices on their networks that can be logged have logs. They should also make sure that intrusion detection systems, firewalls, anti-malware, and security information and event management systems (SIEM) are working and in place, however they may be applicable. These actions will ensure that if an incident indeed occurs, it can be detected and responded to quickly.

Moving on, make sure that there's documentation for all of the hardware, software, network devices, and cloud platforms that the organization uses. The CSIRT should also make sure that people in the organization know how to report incidents and that some people in their incident response team have administrative access to your various systems. Do these things while still being mindful of the principle of least privilege, of course. And the CSIRT should make sure that everyone involved has specific security training, with periodic refreshers and reminders.

#### Detection and Analysis
The next step is detection and analysis. The detection systems from the previous step will identify an anomaly in network behavior, a data breach, malware, or some other indication of compromise. The anomaly should be investigated as to whether or not it's a false positive. If it's a true positive, further analysis should be done to understand its nature, implications, and source. Where did the incident come from?

There are various ways and means of detecting and analyzing cyber incidents, including but not limited to human beings observing suspicious activity, SIEM alerts, alerts from other types of security solutions, anti-malware, file integrity checking software, data loss prevention systems, and logs pertaining to user behavior, applications, cloud services, external storage, memory, network devices, and operating systems.

#### Containment, Eradication and Recovery
The third step is containment, eradication and recovery. Once the metaphorical fire has been found, it's time to make sure that it is extinguished so that it doesn't spread. 
Many types of incidents, such as malware and data breaches, can be obtained. 
Evidence needs to be gathered that can be used to investigate an incident in the following step. Who handled the evidence? Which logs pertain to the incident? What's the pertinent identification information, such as IP addresses, MAC addresses, user accounts, serial numbers, or hostnames?

The source of the incident may be need to be eradicated, such as particular applications, user accounts, or malicious files.

Then they must recover from the incident, restoring systems to normal operation, restoring data from backups, and changing passwords or other means of authentication. Installing patches and reconfiguring firewalls. 

#### Post-incident Activity
The final step is post-incident activity. The organization may hire an outside security firm to help investigate what happened and how similar incidents can be prevented in the future. Either way, members of the CSIRT must have a "lessons learned" meeting to prevent similar incidents from happening in the future, and also perhaps to improve incident response procedures: what happened and when? How did the incident happen? What were the vulnerabilities and exploits that were involved? How can your computers and networks be better security hardened? Do any policies or procedures need to be improved? Does your staff need more security training?
As a red teamer, you will often need to collaborate with the blue team.

#### Malware
Malware is all malicious software. People often refer to any kind of malware as a virus, but computer viruses are just one of the many types of malware.

What is and isn't malware can sometimes be subjective. In the past, some popular applications were considered to be spyware because they track user activity through the developers' servers, without the knowledge of the user. Is that a cyberattack on the confidentiality of an individual's data? Some people would say yes, because the user didn't explicity consent to being monitored. But the developer may claim that the user consented to being monitored by installing the application in the first place.

#### Viruses
Viruses replicated by infecting a file, or multiple files, on a computer and then they copy themselves onto other computers through networks (such as the Internet or a company's LAN) or  through removable media such as CDs, DVDs, and USB drives. These days, the internet is the most common way that viruses spread.

#### Worms
Worms are another way to classify malware according to how it speads form computer to computer. Unlike viruses, worms carry themselves in their own containers rather than needing to alter the contents of existing files on their target.

#### Fileless Malware
Fileless malware is a relatively recent phenomenon, but it is quickly growing problem on all kinds of computers and operating systems. Technically speaking, it does have files, like any data. However, it doesn't write any files on a target's data storage, such as a hard drive. Fileless malware operates completely from the memory of its target machine. Therefore, there isn't a file on a hard drive that can be detected in an antivirus scan. Copied selected text to selection primary: Antivirus evasion is why fileless malware is becoming really popular with cyberattackers. They can cyberattack much more effectively while undetected!

The most common way that fileless malware works is by infecting an operating system process on its target machine. In Windows, processes can be seen by opening Task Manager or Process Explorer. Other operating system platforms have different applications that can be used to see which processes are running. Because of the covert nature of fileless malware, it’s usually detected by observing the behavior of an infected machine.

#### Ransomware
Ransomware describes how this type of malware behaves. Ransomware works by encrypting the files on it's target's data storage with a decryption key that's inaccessible to the victim.

#### Cryptominers
Cryptominers aren't always malware. They use computer processing power to solve complex mathematical problems in order to generate cryptocurrency. Sometimes, a user will consent to allowing a cryptominer to operate on their machine. A cryptominer could be generating cryptocurrency for the user on machines that the user owns, or a user could consent to cryptomining for a developer in order to enjoy a website or application free of charge. When cryptominers run with the user's consent, they aren't malware.

#### Botnets
Botnets are networks of machines of machines that are infected with zombie malware that allows a cyberattacker to control them. Cyberattackers use command and control servers to synchronize all of the zombies in their botnet to execute large-scale attacks. Botnets are also often used to execute DDoS attacks.

#### Spyware
Spyware is malware that threatens a victim's confidentiality. As the name suggests, spyware spies on users. It shows cyberattackers some or all of the activities or data on infected computers. For example, spyware might send an attacker data about your web activity or email.

#### Trojans
Trojans are named after the Trojan horse of Greek mythodology. A Trojan is a file or application that appears to the user as something that they want, but in reality, malware is embedded in the Trojan. For example, a ransomware file that's bound to a photo attached to an email is a Trojan. Some of the popular free screensavers in the 1990s were Trojans.

#### Rootkits
Rootkits acquire unauthorized access to targeted machines, and they try very hard to evade detection. Root is a word that's often used to mean administrative access to a computer, hence its name. A rootkit's malicious actions are those that would require administrative access. For example, let's say that your home PC runs Kubuntu, a verison of Linux. In Linux or UNIX-based systems, users need to enter an administrative password every time they want to do something that requires "root" access, such as when you install new applications from a repository. Rootkits can be very dangerous indeed, because they can possibly do anything to a computer's operating system and applications that you can imagine!

#### Modular Malware
Modular malware is a relatively new cyber threat. Modular malware doesn't just do one thing or another. Rather, it consists of multiple modules that can each perform different kinds of malicious behavior. Modular malware initially appeared on Android devices. Now there's lots of modular malware for pretty much every popular operating system platform on mobile, desktops and servers.
Here's how modular malware usually works. The first component infects a target machine to establish a connection and access for a cyberattacker's command and control servers. Then, over a period of time, the attacker's command and control servers upload a number of different modules. One module could be a rootkit.
The next module could be spyware. The following module could be a cryptominer. Cyberattackers that use modular malware try multiple ways to profit financially from their victims, and it's often deployed by advanced persistent threat groups.

Ao, malware can belong to multiple categories. Spyware can be a worm is that's how it replicates. A rootkit can be a virus. A malicious cryptominer can be fileless malware. Malware was a problem with computers years before personal computers emerged in the late 1970s. And malware is now a bigger problem that ever as the cuber threat landscape continuously evolves.

### Advanced Persistent threats
Advanced persistent threats (APTs) consist of targeted cyberattacks that stay on victims' computers for a long time, possibly months or years, while undetected. They usually come from sophisticated nation-state sponsored cyberattack groups as a part of military cyberwarfare programs. Some APTs nowadays also come from organized crime groups. Kinetic warfare is still with us, as it has been for thousands of years. But as the years go on, more and more military activity is done on computers through the Internet. Sometimes APT groups target utilities like power plants or factories. They often have SCADA systems that are connected to the public Internet, so a lot of damage can be done. At other times, APTs can target office networks, looking for sensitive information or to make a lot of money by infecting many computers with ransomware or malicious cryptominers. It's also not unheard of for APTs to target consumers and their ordinary PC and smartphone endpoints. APTs are also used in red team operations to simulate real-world cyberattacks. MITRE ATT&CK (Adversarial Tactics, Techniques & Common Knowledge) Framework (https://attack.mitre.org/) is a globally accessible knowledge base of adversary tactics and techniques based on real-world observations. The APTs from MITRE ATT&CK detail the latest tactics, techniques, and procedures (TTPs), which can be used to emulate cyberattacks.

### The Cyber Kill Chain

The Cyber Kill Chain Now that you understand what APTs are all about, we'll summarize a methodology for how to deal with them. As a pentester, you won't be responding to real cyberattacks, but it helps to understand what the blue team and security information you give them may be applied.

The kill chain concept originates with kinetic warfare. It involves identifying a target, dispatching the appropriate troops, figuring out how to attack the target effectively according to the context and conditions of battle, and destroying the target. Here's an example of a kill chain methodology that's been commonly used in kinetic warfare for decades. 

F2T2EA is an acronym for its phases: 

	Find: Identify a target through intelligence, 
    surveillance, or reconnaissance. 
	Fix: Acquire coordinates for the target. 
	Track: Monitor the target's movement. 
	Target: Choose the appropriate weapon, assess the 
    value of the target, and check the availability of 
    weapons or other means of attack. 
	Engage: Strike the target! 
	Assess: Evaluate how the attack went and gather 
    intelligence. 

Military contractor Lockheed-Martin developed a kill chain for cybersecurity purposes. The Cyber Kill Chain was published in 2011, designed by computer scientists to address APTs through computer networks. You can read this document for more information.

 www.lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/Gaining_the_Advantage_Cyber_Kill_Chain.pdf

The Cyber Kill Chain consists of the following phases and actions that APTs often take in their attacks: 

Reconnaissance: The cyberattacker or adversary researches their target, looking for vulnerabilities. They could be harvesting email addresses, seeking out employees on social media (especially LinkedIn), looking for Internet-facing servers, and so on. 

Weaponization: The attacker develops or procures malware for remote access that exploits vulnerabilities found in the reconnaissance phase. 

Delivery: Malware is delivered to the target through USB drives, email, phishing sites, compromised websites known as “watering holes,” social media, and so on. 

Exploitation: The malware starts its work. It could be triggered by a human victim interacting with a Trojan, command and control servers, or some other means. 

Installation: Malware is installed by the actions in the previous phase. A shell could be installed for remote command execution, a backdoor could be created, or the cyberattacker could acquire a control interface in some other way. 

Command and Control: The attacker uses the control interface established in the previous phase. A two-way communication channel is created in a covert fashion. 

Actions on Objectives: Now the APT gets what it wants from its target. This phase could involve data theft and corruption, privilege escalation, credential acquisition, or other such malicious actions.

### Common Vulnerabilities and Exposures 
As a pentester, your job is to discover vulnerabilities. Vulnerabilities fall into two basic categories: zero-day vulnerabilities, which are unknown to cyberattack targets until a malicious actor exploits them, and vulnerabilities in hardware, software, and networking devices that you already know about. 

Known vulnerabilities are usually, but not always, recorded in the Common Vulnerabilities and Exposures (CVE) system. If someone specializes in pentesting or red teaming, they may ask you, “Do you have any CVEs?” meaning whether you have made any contributions to the ever-growing CVE database. If you go on to having a successful pentesting or bug hunting career from reading this book, you may have CVEs of your own someday. The CVE database is available to anyone with access to the web. Take a look at it yourself at cve.mitre.org. Each recorded vulnerability in the CVE database is numbered using this format:

CVE-(four digit year)-(four digit number unique to the year) 

The year is when the vulnerability was discovered, of course. For illustrative purposes, we chose a random CVE from 2020, CVE-2020-7060. 

This is the standard format for recording vulnerabilities in the CVE: 

CVE-ID: CVE-2020-7060 

Description: “When using certain mbstring functions to convert multibyte encodings, in PHP versions 7.2.x below 7.2.27, 7.3.x below 7.3.14, and 7.4.x below 7.4.2, it is possible to supply data that will cause function mbfl_filt_conv_big5_wchar to read past the allocated buffer. This may lead to information disclosure or crash.” 

References: A group of URLs with information about this specific vulnerability. 

Assigning CNA: PHP Group. (CNA = CVE Numbering Authority, an organization that contributes to the CVE.) 

Date Entry Created: 20200115 (The format is year, month, day.) A disclaimer says, “The entry creation date may reflect when the CVE ID was allocated or reserved, and does not necessarily indicate when this vulnerability was discovered, shared with the affected vendor, publicly disclosed, or updated in CVE.” 

There are four legacy sections that are basically empty: phase, votes, comments, and proposed. You may see these sections filled in on older reported vulnerabilities.

### Airgapped Machines
An airgapped machine is isolated from as many cyberattack vectors as possible.It won't be connected to any unsecured networks, especially not in the public internet. A really seriously airgapped machine may not be connected to any networks at all. Cyberattacks can sometimes be conducted through removable media or USB devices, so optical drives may be removed or disabled. USB ports are usually disabled. If you need a way to get new data onto an airgapped computer other than through mouse and keyboard input, there may be a removable media interface behind a lock or means of authentication to which only one or a few users have access. And, of course, an airgapped computer is usually in a room with physical and electronic locks that only permit a few specially designated users physical access.

Airgapped machines are normally used to secure highly classified data. obviously, an airgapped computer is really inconvenient to use, so they're used only when absolutely necessary.

Researchers once found a method to penetrate airgapped machines in use by placing a camera that could see the machine through a server room window and record how the hard drive light blinked. The light-blinking patterns could then be used to determine the data that was being written. Mind-blowing, eh? Another means of attacking an airgapped machine would be to bribe one of the few individuals who have physical access to it into carrying out a cyberattack. Humans are often the weakest link!

### The Dark Web
As a pentester, you should understand the role that the dark web plays in cyberattacks.

There are encrypted networks that route the Internet through proxy servers. Two of the most commonly used encrypted proxy networks are Tor and I2P.

Tor stands for The Onion Router, and it was first deployed in 2002. I2P stands for the Invisible Internet Project, and it was first deployed in 2003. The existence of these networks and their use, in of itself, is legal as long as you're not in China. (The Chinese Government uses laws and technologies to restrict citizens' access to the Internet significantly in a system that's often called the Great Firewall of China. Many Chinese do break out of the Great Firewall of China, but doing so is illegal.) In fact, the networks were developed with military technology by both public- and private-sector computer scientists. The Internet outside these encrypted proxy networks is often called the "clearnet." That's the public Internet that you typically use. On the clearnet, your Internet traffic can usually be traced through your gateway IP address and the paths that data takes to and from your endpoint from server to server. On Tor and I2P, a new IP address is used for each proxy node so that the endpoints and servers can usually be traced to the nearest node.

All that you need to use Tor or I2P is a special application on your PC or mobile device. For example, if you want to use the web through Tor, you can install the Tor Browser. It's possible to route most of your usual Internet use through these proxy networks. However, there are also websites that you can only access through Tor or I2P, and those websites are what the dark web is all about. Tor- exclusive websites use the .onion top-level domain, and I2P-exclusive websites use the .i2p top-level domain. 

Not all dark web use is illicit. Sometimes, investigative journalists and political activists in hostile areas of the world use the dark web to communicate messages that are in the public interest, safely and without government interference. In most of the world outside of China, simply using the dark web is legal. Generally, only if you use the dark web to violate the criminal code of your jurisdiction is it illegal. 

The dark web has many websites that use a model based on eBay to sell illegal goods and services. Those are what we refer to as dark web markets. If buyers and sellers with anonymizing usernames have a reputation for honest behavior, they will have positive ratings from the dark web market community. This works much in the same way as buyer and seller reputations on eBay, except that the dark web is geared toward selling illegal and illicit things. Those things can include illegal drugs and firearms. What's relevant to the field of information security is that dark web markets are also used to sell malware, exploit kits, databases of credit card information and other sensitive data, and phishing kits. 

Dark web markets only accept cryptocurrency as payment, as cryptocurrency transactions are more difficult to trace than credit card or PayPal transactions. 

The advent of dark web markets has facilitated cybercrime worldwide. You don't need to be a good programmer or computer scientist to conduct sophisticated cyberattacks. For enough Bitcoin, you can buy malware, exploits, breached information, and the files you need to create phishing websites and emails. Summary